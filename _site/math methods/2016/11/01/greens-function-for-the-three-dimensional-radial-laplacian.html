<!DOCTYPE html>

<html>
  <head>

  <meta charset="utf-8">
  <title>Green's Function for the Three-Dimensional, Radial Laplacian</title>
  
    <meta name="description" content="I derive an expression for the Green's function of the three-dimensional, radial Laplacian. I then spend some time talking about the relevant domain of the solution and how to properly verify the fundamental solution.">
  

  <meta name="author" content="Cyrus Vandrevala">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <link rel="apple-touch-icon" sizes="57x57" href="/assets/ico/apple-touch-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/assets/ico/apple-touch-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/assets/ico/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/assets/ico/apple-touch-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/assets/ico/apple-touch-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/assets/ico/apple-touch-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/assets/ico/apple-touch-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/assets/ico/apple-touch-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/assets/ico/apple-touch-icon-180x180.png">
  <link rel="icon" sizes="16x16" type="image/png" href="/assets/ico/favicon-16x16.png">
  <link rel="icon" sizes="32x32" type="image/png" href="/assets/ico/favicon-32x32.png">
  <link rel="icon" sizes="96x96" type="image/png" href="/assets/ico/favicon-96x96.png">
  <link rel="icon" sizes="192x192" type="image/png" href="/assets/ico/favicon-192x192.png">
  <link rel="icon" sizes="194x194" type="image/png" href="/assets/ico/favicon-194x194.png">
  <link rel="manifest" href="/assets/ico/manifest.json">

  <meta name="msapplication-TileColor" content="#d415a1">
  <meta name="msapplication-TileImage" content="/assets/ico/mstile-144x144.png">
  <meta name="theme-color" content="#d415a1"

  <!--[if lt IE 9]>
    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->

  <link href="/assets/css/reset.css" rel="stylesheet">
  <link href="/assets/css/style.css" rel="stylesheet">

  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-61768963-1', 'auto');
    ga('send', 'pageview');
  </script>

  <link rel="alternate" type="application/rss+xml" title="" href="/feed.xml">

  <!-- Load Javascript Libraries, Fall Back on Local Versions -->

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
  <script>
    if (!window.jQuery) { document.write('<script src="/assets/resources/jquery/jquery.min.js"><\/script>'); console.log("Using local version of jQuery"); }
  </script>

  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  <script>
    if (!window.MathJax) { document.write('<script src="/assets/resources/mathjax/MathJax.js"><\/script>'); console.log("Using local version of MathJax"); }
  </script>

  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.8/d3.min.js"></script>
  <script>
    if (!window.d3) { document.write('<script src="/assets/resources/d3/d3.min.js"><\/script>'); console.log("Using local version of D3"); }
  </script>

</head>

  <body>
  <div class="content">

    <header>
      <div class="container">
        <h2 class="desktop">
          <a href="/"><span></span>cupcake physics</a>
        </h2>

        <h2 class="mobile">
          <a href="/"><span></span></a>
        </h2>

        <span class="hot-dog-menu"></span>

        <nav>
          <ul>
			  <li><input id="search_input" data-toggle="dropdown" type="text" class="form-control" placeholder="Search Posts" autocomplete="off" onkeyup="checkTextField();" /></li>
          </ul>
        </nav>
      </div>
    </header>

	<ul id="search_results" class="dropdown-menu" role="menu"></ul>

    <section>
     <article class="post">
  <div class="container">

    <span class="post-date">
      
      November
      1st,
        
      2016
    </span>

    <h2>Green's Function for the Three-Dimensional, Radial Laplacian </h2>

	
	  
		  <span class="topic math-methods"></span>
		
	
    <span class="difficulty hard"></span>

    <div class="body">
      <h3 id="introduction">Introduction</h3>

<p>The Laplace operator or Laplacian (<script type="math/tex">\nabla^2</script>) appears in a variety of differential equations that describe physical phenomena; topics include gravitational potential, diffusion, electromagnetic fields, quantum mechanics, and many others. All students of physics come across Poisson’s equation since it is one of the simplest, inhomogeneous differential equations involving the Laplacian.</p>

<script type="math/tex; mode=display">\begin{equation}
\nabla^2 \psi = f
\end{equation}</script>

<p>In the expression above, <script type="math/tex">\nabla^2</script> is the Laplacian, <script type="math/tex">f</script> is a known function, and <script type="math/tex">\psi</script> is a function that we must solve for. Techniques like <a href="http://mathworld.wolfram.com/SeparationofVariables.html">separation of variables</a> are commonly used to solve for <script type="math/tex">\phi</script> when <script type="math/tex">f</script> is separable, but solving for <script type="math/tex">\psi</script> can become very complicated in more sophisticated cases.</p>

<p>Green’s functions are a staple in upper-level physics because they can be used to simplify or solve more complicated expressions (like when <script type="math/tex">f</script> is not separable). In this post, we will derive the Green’s function for the three-dimensional Laplacian in spherical coordinates.</p>

<h3 id="derivation-of-the-greens-function">Derivation of the Green’s Function</h3>

<p>Consider Poisson’s equation in spherical coordinates.</p>

<script type="math/tex; mode=display">\begin{equation}
\nabla^2 \psi = f
\end{equation}</script>

<p>We can expand the Laplacian in terms of the <script type="math/tex">(r,\theta,\phi)</script> coordinate system. I looked up the full Laplacian on <a href="http://mathworld.wolfram.com/Laplacian.html">Wolfram Mathworld</a>.</p>

<script type="math/tex; mode=display">\begin{equation}
\left [ \frac{1}{r^2} \frac{\partial}{\partial r} \left ( r^2 \frac{\partial \psi}{\partial r} \right ) + \frac{1}{r^2 sin^2 \phi} \frac{\partial^2 \psi}{\partial \theta^2} + \frac{1}{r^2 sin\phi} \frac{\partial}{\partial \phi} \left ( sin\phi \frac{\partial \psi}{\partial \phi} \right ) \right ] = f
\end{equation}</script>

<p>Since we are only interested in the radial Green’s function, we can immediately simplify the expression above to include only radial terms. Anything with a <script type="math/tex">\theta</script> or <script type="math/tex">\phi</script> gets canceled:</p>

<script type="math/tex; mode=display">\begin{equation}
\frac{1}{r^2} \frac{\partial}{\partial r} \left ( r^2 \frac{\partial \psi}{\partial r} \right ) = f
\end{equation}</script>

<p>We want to find the Green’s function for the Laplace operator. In other words, we are looking for a function <script type="math/tex">G</script> that satisfies:</p>

<script type="math/tex; mode=display">\begin{equation}
\nabla^2 G = 4\pi \delta(r)
\end{equation}</script>

<p>Using the expression for the Laplacian from above, we get:</p>

<script type="math/tex; mode=display">\begin{equation}
\frac{1}{r^2} \frac{d}{dr} \left ( r^2 \frac{dG}{dr} \right ) = 4\pi \delta(r)
\end{equation}</script>

<p>Since the right-hand side of the equation contains a Dirac delta function, it seems natural to integrate both sides with respect to <script type="math/tex">r</script>. The expression becomes:</p>

<script type="math/tex; mode=display">\begin{equation}
\int \frac{1}{r^2} \frac{d}{dr} \left ( r^2 \frac{dG}{dr} \right ) dr = \int 4\pi \delta(r) dr
\end{equation}</script>

<script type="math/tex; mode=display">\begin{equation}
\int \frac{1}{r^2} \frac{d}{dr} \left ( r^2 \frac{dG}{dr} \right ) dr = 4\pi
\end{equation}</script>

<p>The derivatives within the integral suggest that this expression might be simplified by integration by parts. Let’s give it a shot:</p>

<script type="math/tex; mode=display">\begin{equation}
u = \frac{1}{r^2} \Rightarrow du = -\frac{2}{r^3} dr
\end{equation}</script>

<script type="math/tex; mode=display">\begin{equation}
dv = \frac{d}{dr} \left [ r^2 \frac{dG}{dr} \right ] dr \Rightarrow v = r^2 \frac{dG}{dr}
\end{equation}</script>

<p>Thus, the expression becomes:</p>

<script type="math/tex; mode=display">\begin{equation}
\left ( \frac{1}{r^2} \right ) \left ( r^2 \frac{dG}{dr} \right ) - \int \left ( r^2 \frac{dG}{dr} \right ) \left ( -\frac{2}{r^3} dr \right ) = 4\pi
\end{equation}</script>

<script type="math/tex; mode=display">\begin{equation}
\frac{dG}{dr} + 2 \int \frac{1}{r} \frac{dG}{dr} dr = 4\pi
\end{equation}</script>

<p>This integral looks a little simpler, but we can do better! We can use integration by parts a second time to simplify it even further.</p>

<script type="math/tex; mode=display">\begin{equation}
u = \frac{1}{r} \Rightarrow du = -\frac{1}{r^2} dr
\end{equation}</script>

<script type="math/tex; mode=display">\begin{equation}
dv = \frac{dG}{dr} dr \Rightarrow v = G
\end{equation}</script>

<p>We expand the expression once again.</p>

<script type="math/tex; mode=display">\begin{equation}
\frac{dG}{dr} + 2 \left [ \left (\frac{1}{r} \right ) \left ( G \right ) - \int G \left ( -\frac{1}{r^2} dr\right ) \right ] = 4\pi
\end{equation}</script>

<script type="math/tex; mode=display">\begin{equation}
\frac{dG}{dr} + 2 \left [ \frac{G}{r} + \int \frac{G}{r^2} dr \right ] = 4\pi
\end{equation}</script>

<script type="math/tex; mode=display">\begin{equation}
\frac{dG}{dr} + \frac{2G}{r} + 2 \int \frac{G}{r^2} dr = 4\pi
\end{equation}</script>

<p>Dealing with derivatives is usually easier than dealing with integral equations. Thus, we should take the derivative with respect to <script type="math/tex">r</script> on each side in order to eliminate the integral. Note that <script type="math/tex">G</script> is a function of <script type="math/tex">r</script>, so we have to use the quotient rule on the <script type="math/tex">2G/r</script> term. This causes a couple of terms to cancel out nicely.</p>

<script type="math/tex; mode=display">\begin{equation}
\frac{d^2 G}{dr^2} + \left ( \frac{2}{r} \frac{dG}{dr} - \frac{2G}{r^2} \right ) + \frac{2G}{r^2} = 0
\end{equation}</script>

<script type="math/tex; mode=display">\begin{equation}
\frac{d^2 G}{dr^2} + \frac{2}{r} \frac{dG}{dr} = 0
\end{equation}</script>

<p>Hooray! We turned Poisson’s equation for <script type="math/tex">G</script> into a slightly less difficult to solve differential equation for <script type="math/tex">G</script>!</p>

<h3 id="solving-the-second-differential-equation">Solving the Second Differential Equation</h3>

<p>You can solve this new differential equation in a number of ways. I am going to use a tried and true method of analysis - guess and check! I am going to guess a solution of <script type="math/tex">G = A/r</script> since that seems to fit pretty well. The variable A is some constant.</p>

<script type="math/tex; mode=display">% <![CDATA[
\begin{align}
\frac{d^2 G}{dr^2} + \frac{2}{r}\frac{dG}{dr} &=\\
\frac{d^2}{dr^2} \left [ \frac{A}{r} \right ] + \frac{2}{r}\frac{d}{dr} \left [ \frac{A}{r} \right ] &=\\
\frac{2A}{r^3} + \frac{2}{r} \left ( -\frac{A}{r^2} \right ) &=\\
\frac{2A}{r^3} - \frac{2A}{r^3} &= 0
\end{align} %]]></script>

<p>Thus, we see that <script type="math/tex">G = A/r</script> is the solution for our differential equation above. Or is it…?</p>

<p>Update (November 12, 2016): Technically, the solution of this differential equation is <script type="math/tex">G = A/r + B</script> where both <script type="math/tex">A</script> and <script type="math/tex">B</script> are constants. However, we usually set <script type="math/tex">B</script> equal to zero in order to obtain the so-called fundamental solution. The fundamental solution ignores scaling by a constant and instead looks at the properties of how <script type="math/tex">G</script> changes with <script type="math/tex">r</script>.</p>

<h3 id="checking-the-solution">Checking the Solution</h3>

<p>We have a bit of a problem. Suppose I plug <script type="math/tex">G = A/r</script> back into the Laplacian. Let’s see what happens:</p>

<script type="math/tex; mode=display">% <![CDATA[
\begin{align}
\nabla^2 G &= \frac{1}{r^2} \frac{d}{dr} \left [ r^2 \frac{d}{dr} \left ( \frac{A}{r} \right ) \right ]\\
&= \frac{1}{r^2} \frac{d}{dr} \left [ r^2 \left ( -\frac{A}{r^2} \right ) \right ]\\
&= \frac{1}{r^2} \frac{d}{dr} \left [ -A \right ]\\
&= 0
\end{align} %]]></script>

<p>Technically speaking, that is not our expected output. We were expecting a Dirac delta function and instead got zero. So what gives?</p>

<p>Remember, we divided by <script type="math/tex">r</script> throughout the derivation, so the domain of the solution cannot include the origin <script type="math/tex">r = 0</script>. We can, however, analyze the solution in the limiting case. Suppose we define a function <script type="math/tex">\Phi_\epsilon</script> where:</p>

<script type="math/tex; mode=display">\begin{equation}
\Phi_\epsilon = \frac{A}{r + \epsilon}
\end{equation}</script>

<p>As <script type="math/tex">\epsilon</script> approaches zero, <script type="math/tex">\Phi_\epsilon</script> approaches the Green’s function <script type="math/tex">G</script>. Let’s plug the expression <script type="math/tex">\Phi_\epsilon</script> into the Laplacian and turn the crank.</p>

<script type="math/tex; mode=display">% <![CDATA[
\begin{align}
\nabla^2 \Phi_\epsilon &= \frac{1}{r^2} \frac{d}{dr} \left [ r^2 \frac{d}{dr} \left ( \frac{A}{r + \epsilon} \right ) \right ]\\
&= \frac{1}{r^2} \frac{d}{dr} \left [ r^2 \left ( -\frac{A}{(r+\epsilon)^2} \right ) \right ]\\
&= \frac{1}{r^2} \frac{d}{dr} \left [ -\frac{A r^2}{(r+\epsilon)^2} \right ]\\
&= \frac{1}{r^2} \left [ -\frac{2A\epsilon r}{(r+\epsilon)^3} \right ]\\
&= -\frac{2A\epsilon}{r(r+\epsilon)^3}
\end{align} %]]></script>

<p>Ok, we are getting some expression with <script type="math/tex">r</script>’s and <script type="math/tex">\epsilon</script>’s. What does it mean?</p>

<p>Remember, I claimed that the Laplacian of <script type="math/tex">G</script> (or more correctly, the Laplacian of the limiting case of <script type="math/tex">\Phi_\epsilon</script>), will yield <script type="math/tex">4 \pi \delta(r)</script>. If that is true, I should be able to integrate <script type="math/tex">\nabla^2 \Phi_\epsilon</script> over all space and get <script type="math/tex">4\pi</script>. Let’s try doing just that:</p>

<script type="math/tex; mode=display">% <![CDATA[
\begin{align}
\int \nabla^2 \Phi_\epsilon dV &= - \int_0^R \int_0^{2\pi} \int_0^\pi \frac{2A\epsilon}{r(r+\epsilon)^3} r^2 sin\theta dr d\theta d\phi\\
&= - 4\pi \int_0^R \frac{2A\epsilon r}{(r+\epsilon)^3} dr\\
&= - 4\pi A \left [ \frac{r(2\epsilon + r)}{(r+\epsilon)^2} \right ]_0^R\\
&= - 4\pi A \left [ \frac{R(2\epsilon + R)}{(R + \epsilon)^2} \right ]\\
&= - 4\pi A \left [ \frac{R^2 + 2\epsilon R}{R^2 + 2\epsilon R + \epsilon^2} \right ]\\
\end{align} %]]></script>

<p>If we are going to integrate over all space, we need to take the limit of this expression as <script type="math/tex">R \rightarrow \infty</script>. This is a job for L’Hopital’s rule!</p>

<script type="math/tex; mode=display">% <![CDATA[
\begin{align}
\lim_{R \rightarrow \infty} \int \nabla^2 \Phi_\epsilon dV &= \lim_{R \rightarrow \infty} - 4\pi A \left [ \frac{R^2 + 2\epsilon R}{R^2 + 2\epsilon R + \epsilon^2} \right ]\\
&= \lim_{R \rightarrow \infty} - 4\pi A \left [ \frac{2R + 2\epsilon}{2R + 2\epsilon} \right ] = - 4\pi A
\end{align} %]]></script>

<p>It seems that when <script type="math/tex">A = -1</script>, the Laplacian of <script type="math/tex">\Phi_\epsilon</script> satisfies our conditions. Let’s define one last function <script type="math/tex">f_\epsilon(r)</script> to simplify the expression. I promise we are in the home stretch!</p>

<script type="math/tex; mode=display">\begin{equation}
f_\epsilon (r) = \frac{1}{4 \pi A} \nabla^2 \Phi_\epsilon (r) = -\frac{1}{4\pi} \nabla^2 \Phi_\epsilon (r) = \frac{\epsilon}{2\pi r (r+\epsilon)^3}
\end{equation}</script>

<p>We should take a good, long look at this equation in the limit of <script type="math/tex">\epsilon \rightarrow 0</script>. If <script type="math/tex">r</script> is non-zero, the limit is very simple:</p>

<script type="math/tex; mode=display">\begin{equation}
\lim_{\epsilon \rightarrow 0} f_\epsilon (r) = \lim_{\epsilon \rightarrow 0} \frac{\epsilon}{2\pi r (r+\epsilon)^3} = \frac{0}{2\pi r (r)^3} = 0
\end{equation}</script>

<p>If <script type="math/tex">r</script> is equal to zero, we need to use L’Hopital’s rule to simplify the expression.</p>

<script type="math/tex; mode=display">\begin{equation}
\lim_{\epsilon \rightarrow 0} f_\epsilon (r) = \lim_{\epsilon \rightarrow 0} \frac{\epsilon}{2\pi r (r+\epsilon)^3} = \lim_{\epsilon \rightarrow 0} \frac{1}{6 \pi r(r + \epsilon)^2} = \frac{1}{6 \pi r^3}
\end{equation}</script>

<p>This becomes infinitely large when <script type="math/tex">r = 0</script>.</p>

<h3 id="putting-it-all-together">Putting It All Together</h3>

<p>Let’s tie everything together. In the limiting case of <script type="math/tex">\epsilon \rightarrow 0</script>, the function <script type="math/tex">f_\epsilon(r)</script> is infinitely large at the origin and zero everywhere else. This means that <script type="math/tex">f_\epsilon(r)</script> is a Dirac delta function <script type="math/tex">\delta(r)</script>.</p>

<p>The function <script type="math/tex">f_\epsilon(r)</script> is equal to the Laplacian of <script type="math/tex">\Phi_\epsilon</script>, multiplied by a constant. Thus, in the limit as <script type="math/tex">\epsilon \rightarrow 0</script>, the function <script type="math/tex">\nabla^2\Phi_\epsilon</script> is equal to a Dirac delta function (times a constant).</p>

<p>But remember that the limiting case of <script type="math/tex">\Phi_\epsilon</script> as <script type="math/tex">\epsilon \rightarrow 0</script> is equivalent to the Green’s function <script type="math/tex">G = A/r = -1/r</script>. Thus, the Laplacian of the Green’s function is a Dirac delta function times the constant <script type="math/tex">4\pi</script>. This is exactly what we set out to prove in the first place! Woot!</p>

<p>One final thought. You often see the following expression written out in textbooks:</p>

<script type="math/tex; mode=display">\begin{equation}
\nabla^2 \left ( \frac{1}{r} \right ) = -4\pi \delta(r)
\end{equation}</script>

<p>Technically, this is not entirely correct because <script type="math/tex">1/r</script> is undefined at the origin. It should really be written as the following.</p>

<script type="math/tex; mode=display">\begin{equation}
\lim_{\epsilon \rightarrow 0} \left [ \nabla^2 \left ( \frac{1}{r + \epsilon} \right ) \right ] = -4\pi \delta(r)
\end{equation}</script>

<p>This comes directly from the analysis above.</p>

<p>Until next time!</p>

    </div>

	<div id="disqus_thread"></div>
	<script type="text/javascript">
	  /* * * CONFIGURATION VARIABLES * * */
	  var disqus_shortname = 'cupcakephysicsblog';

	  /* * * DON'T EDIT BELOW THIS LINE * * */
	  (function() {
	      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
	      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
	      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	  })();
	</script>
	<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>

  </div>

</article>

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>

    </section>

    <div class="social-media">
      <div class="container">
        <ul>
          <li><a class="button primary" href="/categories.html">Categories</a></li>
          <li><a class="button secondary" href="/tags.html">Tags</a></li>
          <li><a class="button tertiary" href="/about.html">About</a></li>
          <li><a class="social-icon facebook" href="https://www.facebook.com/pages/Cupcake-Physics/1555786914693563" target="_blank"></a></li>
          <li><a class="social-icon twitter" href="https://twitter.com/cupcakephysics" target="_blank"></a></li>
        </ul>
      </div>
    </div>

    <footer>
      <div class="container">
        <p><a href="/">Cupcake Physics</a> by Cyrus Vandrevala | All Rights Reserved</p>
      </div>
    </footer>

  </div>

  <div class="preloader">
    <img src="/assets/images/icons/facebook-hover.png" />
    <img src="/assets/images/icons/twitter-hover.png" />
  </div>

  <!-- Load Javascript Libraries, Fall Back on Local Versions -->

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
  <script>
    if (!window.jQuery) { document.write('<script src="/assets/resources/jquery/jquery.min.js"><\/script>'); console.log("Using local version of jQuery"); }
  </script>

  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  <script>
    if (!window.MathJax) { document.write('<script src="/assets/resources/mathjax/MathJax.js"><\/script>'); console.log("Using local version of MathJax"); }
  </script>

  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.8/d3.min.js"></script>
  <script>
    if (!window.d3) { document.write('<script src="/assets/resources/d3/d3.min.js"><\/script>'); console.log("Using local version of D3"); }
  </script>

  <script type="text/javascript" src="/assets/js/searchbar.js"></script>

</body>

</html>